---
import SearchBar from '../components/SearchBar.astro';
import logoLight from '../assets/zynapte-rxhive-logo-light.png';
import logoDark from '../assets/zynapte-rxhive-logo-dark.png';

const { isHomePage = false } = Astro.props;
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		{/** Use a dynamic title and description when provided via props, fallback to site */}
		<title>{Astro.props.title || 'RxHive'}</title>
		<meta name="description" content={Astro.props.description || ''} />
		{/** canonical using Astro.site + pathname when available */}
		{Astro.site ? <link rel="canonical" href={`${Astro.site}${Astro.url.pathname}`} /> : null}

			{/** Preconnect and robots */}
			<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
			<meta name="robots" content="index, follow" />

			{/* allow pages to inject head-only fragments like JSON-LD via a named slot */}
			{Astro.slots.head ? <slot name="head" /> : null}

			{/** Open Graph / Twitter */}
			<meta property="og:type" content="website" />
			<meta property="og:title" content={Astro.props.title || 'RxHive'} />
			<meta property="og:description" content={Astro.props.description || ''} />
			{Astro.site ? <meta property="og:url" content={`${Astro.site}${Astro.url.pathname}`} /> : null}
			<meta name="twitter:card" content="summary_large_image" />
			<meta name="twitter:title" content={Astro.props.title || 'RxHive'} />
			<meta name="twitter:description" content={Astro.props.description || ''} />
			<meta name="theme-color" content="#ffffff" />
	</head>

	<body>
		<!-- Keep skip link for accessibility but hide visible text -->
		<a href="#content" class="skip-to-content sr-only">Skip to content</a>

		{!isHomePage && (
			<header class="site-header">
				<div class="container header-inner">
					<a href="/" class="brand">
						<img src={logoLight.src} alt="Zynapte RxHive" class="brand-logo brand-logo--light" />
						<img src={logoDark.src} alt="Zynapte RxHive" class="brand-logo brand-logo--dark" />
					</a>
					<div class="header-search">
						<SearchBar />
					</div>
				</div>
			</header>
		)}

		<main id="content" class={isHomePage ? 'main--home' : ''}>
			{isHomePage ? (
				<slot />
			) : (
				<div class="container page-grid">
					<section class="content-column">
						<slot />
					</section>
				</div>
			)}
		</main>

		<footer class="site-footer">
			<div class="container">
				<div>Â© {new Date().getFullYear()} RxHive</div>
				<nav>
					<a href="/sitemap.xml">Sitemap</a>
				</nav>
			</div>
		</footer>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
		/* subtle, transparent background gradient similar to home */
		background: radial-gradient(1200px 600px at 10% 10%, rgba(99,102,241,0.06), transparent 10%),
			linear-gradient(180deg, rgba(59,130,246,0.02), rgba(236,72,153,0.02));
	}
</style>

<style>
  /* Explicit heading sizes to avoid relying on UA defaults (prevent H1UserAgentFontSizeInSection warnings) */
  h1 { font-size: 1.875rem; line-height: 1.2; margin: 0 0 0.5rem; }
  h2 { font-size: 1.25rem; line-height: 1.3; margin: 0 0 0.5rem; }
  h3 { font-size: 1rem; line-height: 1.4; margin: 0 0 0.5rem; }
</style>

<style>
	/* Layout container and grid */
	.container { max-width: 1100px; margin: 0 auto; padding: 28px 20px; }
		/* Reserve header height to avoid layout shifts when fonts or nav render */
		:root { --header-height: 64px; }
		.site-header { 
			background: rgba(15,23,42,0.95); 
			backdrop-filter: blur(12px); 
			color: #fff; 
			min-height: var(--header-height); 
			position: sticky; 
			top: 0; 
			z-index: 100; 
			border-bottom: 1px solid rgba(148,163,184,0.2); 
			padding: 10px 0; 
		}
		.site-header .container { padding-top: 18px; padding-bottom: 18px; }
		.header-inner { 
			display: flex; 
			align-items: center; 
			justify-content: space-between; 
			gap: 18px; 
		}
		.header-inner:has(.header-search) {
			justify-content: space-between;
		}
		.header-inner:not(:has(.header-search)) {
			justify-content: center;
		}
		.brand { 
			display: flex;
			align-items: center;
			text-decoration: none;
			transition: opacity 0.2s ease;
		}
		.brand:hover {
			opacity: 0.8;
		}
		.brand-logo {
			height: 40px;
			width: auto;
			object-fit: contain;
		}
		
		/* Adaptive logo system - show dark logo on light backgrounds, light logo on dark backgrounds */
		.brand-logo--dark {
			display: block;
		}
		
		.brand-logo--light {
			display: none;
		}
		
		@media (prefers-color-scheme: dark) {
			.brand-logo--dark {
				display: none;
			}
			
			.brand-logo--light {
				display: block;
			}
		}
		
		.header-search { 
				display: flex; 
				justify-content: center; 
				flex: 1;
				max-width: 400px;
			}

		.page-grid { display:grid; grid-template-columns: 1fr; gap: 24px; align-items:start; }
	.content-column { padding: 12px 0; }
	.sidebar { }

	.main--home {
		background: linear-gradient(135deg, 
			rgba(59,130,246,0.03) 0%, 
			rgba(147,51,234,0.03) 50%, 
			rgba(236,72,153,0.03) 100%);
		padding: 0;
		min-height: 100vh;
	}

		/* Image defaults to avoid layout shifts from images loading */
		img { max-width: 100%; height: auto; display: block; }

	/* Simple article/card style for content */
	article { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 6px 18px rgba(15,23,42,0.06); }
	.card { background:#fff; padding:12px; border-radius:8px; box-shadow: 0 4px 12px rgba(2,6,23,0.04); margin-bottom:12px; }

	.site-footer { border-top:1px solid #e6eef8; margin-top:36px; padding:18px 0; color:#374151; }
	.site-footer a { color: #374151; text-decoration:none; margin-left:12px; }

	@media (max-width: 900px) {
		.header-search { max-width: 320px; }
		.page-grid { grid-template-columns: 1fr; }
		.sidebar { order: 2; }
		.header-inner {
			flex-direction: column;
			gap: 16px;
		}
		.header-inner:has(.header-search) {
			justify-content: center;
		}
	}

	@media (max-width: 640px) {
		.site-header .container { padding-top: 16px; padding-bottom: 16px; }
		.brand { font-size: 1.35rem; letter-spacing: 0.06em; }
		.header-search { max-width: 100%; }
	}
</style>

<style>
	/* screen-reader-only utility: visually hidden but available to assistive tech */
	.sr-only {
		position: absolute !important;
		width: 1px !important;
		height: 1px !important;
		padding: 0 !important;
		margin: -1px !important;
		overflow: hidden !important;
		clip: rect(0, 0, 0, 0) !important;
		white-space: nowrap !important;
		border: 0 !important;
	}
</style>
